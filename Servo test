#include <mega128.h>
#include <io.h>
#include <delay.h>

void Init_Timer3A(void)
{
    TCCR3A = 0xAA;
    TCCR3B = 0x1A;
    
    OCR3AH = 3000>>8;
    OCR3AL = 3000&0xff;
    DDRE = 0x08;
    ICR3H = 39999>>8;
    ICR3L = 39999>>0xff;
    }
    
void Servo_motor(int angle)
{
    OCR3AH = (angle*14+3640)>>8;
    OCR3AL = (angle*14+3640)&0xFF;
    }
    
void main(void)
{
        Init_Timer3A();
        
        while(1)
        {
            Servo_motor(45);
            delay_ms(2000);
            Servo_motor(-45);
            delay_ms(2000);
            }
}